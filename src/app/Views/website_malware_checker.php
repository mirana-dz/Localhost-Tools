<?php include '../app/includes/header.php'; ?>

    <script>
        let doMalwareCheck,
            doMalwareCheckAll;

        $(document).ready(function () {
            let selectOption = $('#selectOption'),
                searchEngineValue = selectOption.val();

            $(document).on('change', '#selectOption', function () {
                searchEngineValue = selectOption.val();
            });

            doMalwareCheck = function () {
                if ($("form").valid()) {
                    malwareCheck(1);
                }
            }

            doMalwareCheckAll = function () {
                if ($("form").valid()) {
                    malwareCheck(2);
                }
            }

            function malwareCheck(n) {
                const input_value = $('#input').val();
                let searchEngineValue = selectOption.val(),
                    googleSafeBrowsing = 'https://transparencyreport.google.com/safe-browsing/search?url=' + input_value,
                    nortonSafeWeb = 'https://safeweb.norton.com/report/show?url=' + input_value,
                    mcAfeeWebAdvisor = 'https://www.siteadvisor.com/sitereport.html?url=' + input_value,
                    bitDefenderTrafficLight = 'https://trafficlight.bitdefender.com/info?url=' + input_value,
                    phishTank = 'https://checkurl.phishtank.com/checkurl/index.php?url=' + input_value,
                    fortiGuard = 'https://www.fortiguard.com/search?q=' + input_value + '&engine=1',
                    // Get realLocation + delete http:// & delete :/ from url
                    sucuri = input_value.replace(/\/$/, "").replace("http://", "").replace("https://", "https/"),
                    sucuriSiteCheck = 'https://sitecheck.sucuri.net/results/' + sucuri;

                switch (n) {
                    case 1:
                        switch (searchEngineValue) {
                            case 'google':
                                window.open(googleSafeBrowsing, "_blank");
                                break;
                            case 'norton':
                                window.open(nortonSafeWeb, "_blank");
                                break;
                            case 'mcafee':
                                window.open(mcAfeeWebAdvisor, "_blank");
                                break;
                            case 'bitdefender':
                                window.open(bitDefenderTrafficLight, "_blank");
                                break;
                            case 'phishtank':
                                window.open(phishTank, "_blank");
                                break;
                            case 'fortiguard':
                                window.open(fortiGuard, "_blank");
                                break;
                            case 'sucuri':
                                window.open(sucuriSiteCheck, "_blank");
                                break;
                        }
                        break;
                    case 2:
                        // Allow Pop-ups for 127.0.0.1
                        window.open(googleSafeBrowsing, "_blank");
                        window.open(nortonSafeWeb, "_blank");
                        window.open(mcAfeeWebAdvisor, "_blank");
                        window.open(bitDefenderTrafficLight, "_blank");
                        window.open(phishTank, "_blank");
                        window.open(fortiGuard, "_blank");
                        window.open(sucuriSiteCheck, "_blank");
                        break;
                }
            }
        });
    </script>

<?php
echo $pageDescription;
$form = new Form('POST', 'my-form-preventDefault', 'inputForm');
$form->input('input', 'Enter URL (with http://):', 'text', array('class' => 'input-url'));
$form->select('selectOption', 'Select search engine:', array(
    'google' => 'Google Safebrowsing',
    'norton' => 'Norton SafeWeb',
    'mcafee' => 'McAfee WebAdvisor',
    'bitdefender' => 'Bitdefender TrafficLight',
    'phishtank' => 'PhishTank',
    'fortiguard' => 'FortiGuard',
    'sucuri' => 'Sucuri'
), 'google');
$form->button('action', 'encode', 'Check Malware Status', array('class' => 'button', 'onclick' => 'doMalwareCheck()'));
$form->button('action2', 'encode', 'Check All', array('class' => 'button', 'onclick' => ' doMalwareCheckAll()'));
echo $form->render();

include '../app/includes/footer.php'; ?>